Приложение для расчета земляных работ при проектировании кабельных линий
Общие сведения о проектировании кабельных линий
Одним из направлений работы Проектного бюро является проектирование кабельных линий (далее - КЛ) напряжением 0,4 – 35 киловольт, в том числе:
 - для временного электроснабжения машин и механизмов при строительстве крупных объектов электроэнергетики;
- для электроснабжения внутренних потребителей промышленных объектов;
- для сетей электроснабжения и электроосвещения объектов культуры, спорта и других гражданских объектов.
С точки зрения проектирования, трасса кабельной линии на плане представляет собой линию, начинающуюся от источника (обычно подстанция) до потребителя (другая подстанция, силовые щиты, подъемные краны и т.д.). Трасса имеет прямые участки (обозначаются как СТ с указанием номера участка), на которых в земле прокладываются электрические кабели. На одном участке может быть несколько условий прокладки, например, в обычных условиях кабели прокладываются просто в траншее, а при пересечении с подземными коммуникациями и под дорогами – в трубах.
 
Рис.1. План прокладки кабельных линий (пример)
Трасса кабельной линии имеет углы поворота, меняющие направление трассы в зависимости от наличия зданий и сооружений на поверхности земли. Трасса может иметь разветвленную структуру – иметь ответвления, и, следовательно, на разных участках иметь разное количество кабелей (и условий прокладки).
Одним из этапов проектирования кабельной линии является разработка ведомости объемов земляных работ (ведомость объемов земляных работ является частью ведомости объемов работ на прокладку кабельной линии), включающая:
- рытье траншеи определенной глубины (определяется нормативными документами) и шириной, зависящей от количества прокладываемых кабелей на каждом конкретном участке. Извлеченный грунт частично складируется в отвал рядом с траншеей, частично вывозится самосвалами на свалку;
-  подсыпку из привозного песка определенной толщины под кабель (при обычной прокладке в земле) и под трубу (на пересечениях с подземными коммуникациями и дорогами кабели прокладываются в трубах);
- засыпку кабелей и труб привозным песком определенной толщины,
- засыпку оставшейся части траншеи ранее извлеченным грунтом из отвала.
Глубина и другие характеристики траншей, применяемых для прокладки кабельных линий по плану, приведенному на Рис.1, представлены на Рис.2
 
Рис.2. Разрезы траншей
Объемы земляных работ определяются как сумма произведений длин участков на площадь сечения того или иного элемента траншеи (слоев подсыпки, засыпки) на каждом из них. Длины участков с указанием типа траншей на каждом из них сводятся в Ведомость траншей – см. Рис.3.
 
Рис.3 Ведомость траншей
Ввиду большого разнообразия методов прокладки кабеля в зависимости от класса напряжения, количества кабелей в траншее, особых условия прокладки, требований резервирования на ответственных участках трассы и т.д., разрезов траншей может быть большое количество.
Автоматизация расчета земляных работ
Для облегчения расчета объемов земляных работ в MS SQL Server создана база данных CableLines и в ней таблица dbo.Excavation для хранения типов траншей с их параметрами (далее - Таблица траншей). Таблица состоит из 6 столбцов:
-  Trenchid – ID траншеи;
- TrenchType – тип траншеи;
- TrenchDepth – глубина траншеи, м;
- TrenchWidth – ширина траншеи по дну, м;
- SandFilling – толщина слоя подсыпки песка, м;
- SandBackFilling – толщина слоя засыпки песком, м.
Первоначальное заполнение таблицы реализовано через скрипт, содержащий запрос INSERT с перечислением сразу нескольких типов траншей.
Для работы с Таблицей траншей создано настольное приложение Windows Form на языке C# (далее – Приложение). Приложение позволяет:
- вызывать из базы данных все строки таблицы траншей и просматривать их;
- добавлять и удалять данные (в таблицах на экране приложения);
- добавлять и удалять данные (в базе данных MS SQL Server).
(Вводимые в Приложение символы должны быть на английской раскладке клавиатуры.)
Роли приложения
Планируется присвоить приложению всего две роли: Администратор и Пользователь (проектировщик) с разграничением их полномочий.
Администратор преимущественно работает с базой данных (непосредственно в ней) и осуществляет следующие действия:
-	создает базу данных и таблицы в ней;
-	осуществляет заполнение таблиц параметрами применяемых объектов (в данном случае – траншей), видами работ, изделиями и материалами;
-	осуществляет проверку адекватности данных в базе данных, осуществляет замену, корректировку и удаление данных из базы.
Работа с Приложением у Администратора сводится к следующим действиям:
-	выполняет настройку путем привязки к базе данных через установление имени сервера (в программном коде);
-	может осуществлять просмотр и сортировку данных в Таблице траншей на экране Приложения;
-	ввиду небольшого списочного состава Проектного бюро в основном выполняет функции Пользователя.
Пользователь осуществляет следующие действия:
-	На основании плана прокладки кабельных линий (см. Рис.1) в Приложении создает ведомость траншей (см. Рис.3). Для столбца “Наименование” выбирает типы траншей из базы данных в зависимости от количества кабелей на участке и условий прокладки (кабель в трубе либо в траншее), а столбцы номеров участков траншей (СТ-) заполняет длинами участков в соответствии с планом. (Данная функция будет реализована впоследствии).
-	Имеет возможность вручную вносить новые типы траншей Таблицу траншей в базе данных.
-	Удаление каких-либо данных из таблиц базы данных недоступно.
Требования к дальнейшему увеличению функционала
В дальнейшем планируется увеличение функционала Приложения:
- Приложение должно осуществлять проверку одинаковости количества кабелей на одном участке при различных условиях прокладки (в траншее или в трубе).
- Приложение должно иметь проверку на уникальность типов траншей при заполнении Таблицы траншей.
- планируется усовершенствовать Приложение до возможности полного расчета всех работ и материалов при проектировании кабельной линии, включающих в себя и другие элементы, представленные на разрезах траншей, такие как кабели, бетонные плиты, сигнальная лента, трубы и другие с одновременным автоматическим заполнением документов “Спецификация” и “Ведомость объемов работ”.
- планируется нарастить количество используемых таблиц базы данных, например, важными перспективными таблицами будут “Работы”, “Материалы” и “Изделия”.

Прилагаемые материалы.
1.	Скрипт для создания базы данных и таблицы траншей.
2.	Скрипт для заполнения таблицы траншей.
